<?php

namespace App\Console\Commands;

use App\Libraries\Wxxcx;
use App\Models\StudentStatus;
use App\Models\VisitorHistory;
use App\Student;
use App\Visitor;
use Illuminate\Console\Command;

class Notice extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'notice';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Command description';

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {
        //

        $temp = '0B900BB30BA80BBA0BCE0BC10BC60BCE0BC00BD20BD80BD90BE80BE50BE80BE20BCA0BC50BB60BB50BB80BA50BA50BA40B9A0B9E0B9D0B890B7F0B840B7B0B5F0B940BB50BB40BB80BC90BD00BD10BC50BE20BD10BD80BE00BEE0BE00BE20BDE0BD90BD80BCC0BC10BC40BBA0BB60BAA0B960B910BA30B890B800B890B7D0B680BB20BB90BCA0BCD0BCD0BDA0BE40BDA0BDA0BE10BDC0BE20BF30BF60BF00BE80BDA0BF40BD50BC90BCB0BCA0BB00BB00BA10BB60B9B0B950B8A0B870B7A0B790BAD0BBF0BD60BDA0BCF0BDC0BE60BDB0BE60BF90BEA0BE80BEF0BEE0BED0BF70BE50BE20BE00BCE0BDB0BB40BB40BB00B9C0BA70B8C0B990B950B8C0B7E0B8C0B9F0BAD0BC20BD00BE50BE30BD80BDB0BDA0BE20BE10BEA0BDB0BEE0BE40BE60BE90BEE0BDE0BCF0BDA0BCC0BAA0BA50BA20B9D0B8F0BA60BA00B8E0B990B8B0BAA0BBD0BD40BCC0BCD0BD40BDA0BDA0BEB0BDF0BEE0BE60BEF0BDA0BDF0BDF0BDC0BDA0BD40BDD0BEE0BCF0BB50BAC0BA90B980B980BA20B9A0B990B8E0B880BB20BA90BC70BC80BCF0BDB0BE70BDF0BE10BDF0BE90BE40BE50BE30BDB0BDE0BD80BD10BDA0BE10BD90BBF0BAD0BB00BA70B9F0BA10B8C0B940B990B8F0B940B9D0BB20BAF0BC60BC50BBE0BC00BCD0BE40BDD0BEE0BDC0BD60BCA0BCA0BB80BB10BB20BC60BBE0BD00BBC0BB40BA00BB70BA30BA00B990B950B9C0B870B8C0BA80BB40BB20BB50BC10BC20BC20BC80BCD0BCB0BCC0BC10BCE0BC20BC80BB10BB30BB00BB30BB10BB40BBC0BAB0BB40BB00BA30BA20BAB0B930B940B8D0BA80BA80BAE0BA60BC60BC20BBF0BC50BD00BD10BE70BDE0BCB0BD00BC20BC40BBF0BB30BBB0BB70BBA0BBF0BC80BB30BAE0BB40B9D0BA50BAB0BA70BA30B9F0B9C0BB90BAA0BBE0BBF0BBD0BC00BC30BD70BD60BE80BE50BD20BD20BD40BC80BC00BAA0BC60BBD0BAD0BD50BC60BC00BAD0BA60BA40B960BA10B9E0B9D0B9C0B980BB40BAD0BB30BBF0BBB0BC20BC00BE20BD90BEC0BE50BE50BD90BD50BC90BC60BB20BB00BB20BB90BD30BCF0BB20BB90BA60BB40BA90BA30BA20B980B9E0B8D0BAE0BCC0BBF0BC20BBC0BD70BD60BE80BF20BEB0BE20BDA0BE50BC70BD30BB70BB70BB00BBA0BD20BD40BD60BB40BAE0BA00BA20BA30BAE0B940BA20B8E0B9A0BB80BCB0BE50BE50BEE0BEE0BE40BF10BE60BE60BF10BEE0BE80BEE0BEF0BE60BDD0BDA0BE70BEF0BDE0BD10BB20BA30B9A0BAA0BA00BA20B9C0BA50BA30B9E0BC40BD50BEA0BED0BE10BF70BEE0BE20BEB0BDF0BEC0BE00BEB0BFC0BE90BE70BE60BE90BE00BE80BDC0BC10BB20BAB0BB20BA70BA30B9E0BA30B980BA40B980BB60BD80BDE0BEA0BDB0BEA0BEA0BEA0BE80BE50BEF0BEE0BF60BF30BEE0BEA0BEE0BD90BE40BE10BDA0BB20BAB0BA90B9C0BB20BAF0B9E0BA90B9E0B9E0B9F0BB60BC50BC60BEE0BF20BE40BE80BE70BEA0BD40BEE0BEB0BEA0BEC0BEC0BEF0BE90BED0BE90BD10BB20BAA0B9E0B9B0BA40BA20B9A0B990B9E0B9D0B980B950BB20BBE0BC50BE70BEF0BE10BE60BEE0BE10BE40BE30BE50BEC0BE80BE40BE70BE60BE00BDA0BC30BA50BAA0BAC0BA80BA10BA70BB00B960B980BAD0B9C0B9D0BBF0BC40BBB0BDE0BE40BE80BE80BE60BD80BE50BE60BE10BE80BFC0BE40BE80BEA0BF30BE10BB00BAB0BA70B9E0BA60BA20BAC0B990BA20B9B0B9F0B8D0B9D0BB10BB00BAD0BDE0BE20BF00BE80BDA0BED0BD90BD70BE70BEE0BE20BEE0BF20BDC0BE40BD80BB40BAB0BB20B980BA10BAC0BA40B9A0B960B9C0B9B0B9B0BA00BA60BAD0BB70BC60BE90BF40BE60BE20BEE0BE40BE90BDD0BE40BF30BEE0BE60BE70BD00BAE0BA60BA50BA00BA50BB70BA10BAA0B9E0B9C0B9D0BA60B9C0B8F0BBB0BA40BB40BB60BD30BEC0BEB0BE80BE50BF50BEA0BED0BEC0BE50BEB0BE70BE00BC90BAF0BA30BAF0BA30BA50BB30BA20B9C0B9E0B940B970BA00B950B900BA80BAC0BB00BBC0BCC0BE50BEA0BF90BF00BF20BEE0BF50BF00BF30BEF0BE70BEE0BC60BB50BA90BAB0BAF0BB00BA60BAF0B9F0B9D0B940B8F0B9A0B9A0B980BA80BB30BAC0BB40BC50BED0BE90BF20BF00BEA0BEE0BEA0BF00BEF0BEE0BEE0BE80BB50BA90BA80BAA0BA70BA60BA20BAC0BAA0B960B990B9A0B950BA50B9D0BAD0BC20BC00BD70BE50BF10BE70BDE0BE30BE50BF80BEB0BE50BE90BE20BEA0BEB0BB80BA70BA40BAA0BB00BA80B9D0B9E0B9B0B9F0B8B0B950B9F0B930B8A0BC30BD20BC90BD40BE70BE60BE40BDE0BD90BEB0BD80BE80BF00BEE0BEC0BF60BEA0BD00BD30BC60B9E0BA50BA60B9D0B9B0B9A0B990BA60B940B960B930B8E0BC90BD10BD20BD90BDB0BDD0BE80BEB0BE70BE20BD60BE30BF10BE90BF30BEE0BE30BE30BDE0BC30BC50BAD0BA40BA80BA40B990B9D0B940B840B7D0B7F0B8F0BC20BDB0BCA0BE40BED0BEC0BE80BDA0BE20BE10BD70BEE0BE90BF30BF40BF00BEA0BEA0BDD0BDD0BCE0BA80BBD0BA80BAC0B950B980B880B8B0B930B970B820BC60BC60BD00BD70BEF0BE50BE90BE20BF00BDF0BED0BEB0BE30BEF0BE90BE40BE30BE50BCE0BD10BC00BB80BBB0BBF0BAF0B9B0BA00B880B960B900B8B0B730BC60BDC0BC20BE50BEE0BEE0BD50BE00BE50BDD0BE60BE40BF40BE00BE60BDF0BE50BE90BDA0BC10BC80BC20BD40BB70BAF0BB20BC10B8C0B960B790B760B720BC20BC60BD20BD30BDF0BD60BE80BDD0BDD0BDF0BDB0BE90BE40BF00BE80BF50BE30BDF0BDB0BC40BCE0BBB0BDB0BC10BB40BB20BA10BA50B9A0B820B830B6F0BB90BD10BDA0BD50BCF0BD80BDC0BDE0BE30BDA0BEE0BEE0BEF0BFB0BDA0BEC0BD60BD40BDA0BBC0BC80BC80BBC0BB30BB20BC20BA10BBF0B9B0B8D0B7E0B69';
//        dd(strlen($temp));
        $tempArr = [];
        for ($i=0;$i<4096;$i++){
            if ($i%4==0){
                $temp1 = substr($temp,$i,4);
                $temp2 = hexdec(substr($temp1,0,2))*256+hexdec(substr($temp1,2,2))-2731;
                array_push($tempArr,$temp2);
            }
        }
        for ($i=0;$i<32;$i++){
            for ($j=0;$j<32;$j++){
                if ($tempArr[$i*32+$j]<250){
                    printf(0);
                }elseif ($tempArr[$i*32+$j]>=250&&$tempArr[$i*32+$j]<=300){
                    printf(0);
                }elseif ($tempArr[$i*32+$j]>=300&&$tempArr[$i*32+$j]<=320){
                    printf(1);
                }elseif($tempArr[$i*32+$j]>=300&&$tempArr[$i*32+$j]<=370){
                    printf(2);
                }elseif($tempArr[$i*32+$j]>=370&&$tempArr[$i*32+$j]<=420){
                    printf(3);
                }else{
                    printf(5);
                }
            }
            printf("\n");
        }
        return 0;
        dd($tempArr);
        return 0;

        $student=Student::where('stu_status','=',1)->orWhere('stu_status','=',2)->get();
        $template="sExfJnV0OMkzfcSNSNxpBbl6DrLO2VLXfIPCejmM1lM";
        foreach ($student as $value){
            $count=StudentStatus::where('student_id',$value->stu_id)->count();
            if ($count == 0){
                $data=[
                    'touser'=>$value->user_openid,
                    'template_id'=>$template,
                    'miniprogram'=>[
                        'appid'=>""
                    ],
                    'data'=>[
                        'first'=>[
                            'value'=>"您好,审核申请已经有结果了"
                        ],
                        'keyword1'=>[
                            'value'=>$value->stu_name
                        ],
                        'keyword2'=>[
                            'value'=>$value->stu_status==1?'通过':'不通过'
                        ],
                        'keyword3'=>[
                            'value'=>date('Y年m月d H:i:s')
                        ],
                        'remark'=>[
                            'value'=>$value->stu_status==1?"审核通过":"审核不通过,请重新提交"
                        ]
                    ],
                ];
                $access_token=getUserToken('access_token');
                if ($access_token){
                    $url=sprintf('https://api.weixin.qq.com/cgi-bin/message/template/send?access_token=%s',$access_token);
                    $wx=new Wxxcx('wxa45e3bb7239c5059','65c369313719a3e02d9b905f13d9981e');
                    $redata = $wx->request($url,json_encode($data));
                    dump($redata);
                    if ($redata['errcode']==0){
                        $stu=new StudentStatus();
                        $stu->student_id=$value->stu_id;
                        $stu->stu_status=$value->stu_status;
                        $stu->save();
                    }else{
                        setRedisData('refresh',1);
                    }
                }else{
                    setRedisData('refresh',1);
                }
            }
        }
        $str = '00111222222222100011000000000000
                00112222222222211100100000000000
                01112122222221221111111000000000
                00012222222222222212210000000000
                00011011222222222222210000000000
                00001012222222222222110000000000
                00000000011121110011210000000000
                00000000000000000000000000000000
                00000001002210000000000000000000
                00000000022200000000000000000000
                10000000122220100000000000000000
                12201011222221000000010000000000
                12222222222222211111210000000000
                22222222221222222222210000000000
                12222222222222222222110000000000
                12222222222222222222110000000000
                01122222222222222222100000000000
                01222222222222222221100000000000
                00122222222222222211000000000000
                00112222221212222220000000000000
                00022222122212222220000000000000
                01122222222222222210000000000000
                01022122122222222100000000000000
                00122222222222222000000000000000
                00012222222222221000000000000000
                00122222222222220000000000000000
                00022222222212220000000000000000
                00211212222222220000000000000000
                02212222222222220000000000000000
                02222222212222220000000000000000
                12221122222222220000000000000000
                11221222122221222000000000000000
';

    }
}
